{"ast":null,"code":"// routes/attendance.js\nconst express = require(\"express\");\nconst router = express.Router();\nconst auth = require(\"../middleware/authMiddleware\");\nconst Attendance = require(\"../models/Attendance\");\nconst Employee = require(\"../models/Employee\");\n\n// ========================= LẤY LỊCH SỬ CHẤM CÔNG =========================\nrouter.get(\"/\", auth([\"admin\", \"employee\", \"manager\"]), async (req, res) => {\n  try {\n    let employees, attendanceRecords;\n    if (req.user.role === \"admin\") {\n      employees = await Employee.find().populate(\"userId\", \"username role\");\n      attendanceRecords = await Attendance.find().populate(\"userId\", \"username role\");\n    } else {\n      employees = await Employee.find({\n        userId: req.user.id\n      }).populate(\"userId\", \"username role\");\n      attendanceRecords = await Attendance.find({\n        userId: req.user.id\n      }).populate(\"userId\", \"username role\");\n    }\n\n    // tạo map userId → danh sách record\n    const attendanceMap = new Map();\n    attendanceRecords.forEach(a => {\n      var _a$userId;\n      const uid = (_a$userId = a.userId) === null || _a$userId === void 0 ? void 0 : _a$userId._id.toString();\n      if (!attendanceMap.has(uid)) attendanceMap.set(uid, []);\n      attendanceMap.get(uid).push(a);\n    });\n\n    // đảm bảo mỗi nhân viên đều có hàng hiển thị\n    const result = [];\n    for (const emp of employees) {\n      var _emp$userId;\n      const uid = (_emp$userId = emp.userId) === null || _emp$userId === void 0 ? void 0 : _emp$userId._id.toString();\n      const records = attendanceMap.get(uid);\n      if (records && records.length > 0) {\n        records.forEach(r => {\n          var _r$lateMinutes, _r$overtimeHours, _r$totalDays;\n          result.push({\n            _id: r._id,\n            userId: r.userId,\n            date: r.date,\n            checkIn: r.checkIn,\n            checkOut: r.checkOut,\n            lateMinutes: (_r$lateMinutes = r.lateMinutes) !== null && _r$lateMinutes !== void 0 ? _r$lateMinutes : 0,\n            overtimeHours: (_r$overtimeHours = r.overtimeHours) !== null && _r$overtimeHours !== void 0 ? _r$overtimeHours : 0,\n            totalDays: (_r$totalDays = r.totalDays) !== null && _r$totalDays !== void 0 ? _r$totalDays : 0\n          });\n        });\n      } else {\n        result.push({\n          _id: uid + \"-empty\",\n          userId: emp.userId,\n          date: null,\n          checkIn: null,\n          checkOut: null,\n          lateMinutes: 0,\n          overtimeHours: 0,\n          totalDays: 0\n        });\n      }\n    }\n\n    // sắp xếp theo username\n    result.sort((a, b) => {\n      var _a$userId2, _b$userId;\n      return (((_a$userId2 = a.userId) === null || _a$userId2 === void 0 ? void 0 : _a$userId2.username) || \"\").localeCompare(((_b$userId = b.userId) === null || _b$userId === void 0 ? void 0 : _b$userId.username) || \"\");\n    });\n    res.json(result);\n  } catch (err) {\n    console.error(\"❌ Lỗi lấy chấm công:\", err);\n    res.status(500).json({\n      error: err.message\n    });\n  }\n});\n\n// ========================= CHECK-IN =========================\nrouter.post(\"/check-in\", auth([\"admin\", \"employee\", \"manager\"]), async (req, res) => {\n  try {\n    var _record;\n    const today = new Date().toISOString().split(\"T\")[0];\n    let record = await Attendance.findOne({\n      userId: req.user.id,\n      date: today\n    });\n    if ((_record = record) !== null && _record !== void 0 && _record.checkIn) {\n      return res.status(400).json({\n        error: \"Hôm nay bạn đã Check-in rồi.\"\n      });\n    }\n    const now = new Date();\n    const checkInTime = new Date(now);\n    const workStart = new Date(now.setHours(7, 0, 0, 0)); // 7:00 sáng\n    const workEnd = new Date(now.setHours(17, 0, 0, 0)); // 17:00 chiều\n\n    // tính đi trễ (phút)\n    const diffMinutes = Math.floor((checkInTime - workStart) / 60000);\n    const lateMinutes = diffMinutes > 0 ? diffMinutes : 0;\n\n    // tạo bản ghi mới\n    record = new Attendance({\n      userId: req.user.id,\n      date: today,\n      checkIn: checkInTime,\n      checkOut: workEnd,\n      // ✅ mặc định 17h chiều\n      lateMinutes,\n      totalDays: 1,\n      // ✅ có check-in = 1 ngày công\n      overtimeHours: 0,\n      status: \"Present\"\n    });\n    await record.save();\n    res.json({\n      message: \"✅ Check-in thành công (ra 17:00 mặc định)\",\n      record\n    });\n  } catch (err) {\n    console.error(\"❌ Lỗi check-in:\", err);\n    res.status(500).json({\n      error: err.message\n    });\n  }\n});\n\n// ========================= BẮT ĐẦU TĂNG CA =========================\nrouter.post(\"/overtime\", auth([\"admin\", \"employee\", \"manager\"]), async (req, res) => {\n  try {\n    const today = new Date().toISOString().split(\"T\")[0];\n    const record = await Attendance.findOne({\n      userId: req.user.id,\n      date: today\n    });\n    if (!record) return res.status(404).json({\n      error: \"Bạn chưa Check-in hôm nay.\"\n    });\n    const now = new Date();\n    const overtimeStartMinutes = now.getHours() * 60 + now.getMinutes();\n    if (overtimeStartMinutes < 17 * 60) {\n      return res.status(400).json({\n        error: \"⏰ Tăng ca chỉ được bắt đầu sau 17:00.\"\n      });\n    }\n    record.overtimeStart = now;\n    await record.save();\n    res.json({\n      message: \"✅ Bắt đầu tăng ca\",\n      record\n    });\n  } catch (err) {\n    console.error(\"❌ Lỗi bắt đầu tăng ca:\", err);\n    res.status(500).json({\n      error: err.message\n    });\n  }\n});\n\n// ========================= KẾT THÚC TĂNG CA =========================\nrouter.post(\"/overtime/checkout\", auth([\"admin\", \"employee\", \"manager\"]), async (req, res) => {\n  try {\n    const today = new Date().toISOString().split(\"T\")[0];\n    const record = await Attendance.findOne({\n      userId: req.user.id,\n      date: today\n    });\n    if (!record || !record.overtimeStart) return res.status(404).json({\n      error: \"Bạn chưa bắt đầu tăng ca.\"\n    });\n    record.overtimeEnd = new Date();\n    const overtimeHours = Math.max(0, (record.overtimeEnd - record.overtimeStart) / 36e5);\n    record.overtimeHours = Math.round(overtimeHours * 100) / 100;\n    await record.save();\n    res.json({\n      message: \"✅ Kết thúc tăng ca\",\n      record\n    });\n  } catch (err) {\n    console.error(\"❌ Lỗi kết thúc tăng ca:\", err);\n    res.status(500).json({\n      error: err.message\n    });\n  }\n});\nmodule.exports = router;","map":{"version":3,"names":["express","require","router","Router","auth","Attendance","Employee","get","req","res","employees","attendanceRecords","user","role","find","populate","userId","id","attendanceMap","Map","forEach","a","_a$userId","uid","_id","toString","has","set","push","result","emp","_emp$userId","records","length","r","_r$lateMinutes","_r$overtimeHours","_r$totalDays","date","checkIn","checkOut","lateMinutes","overtimeHours","totalDays","sort","b","_a$userId2","_b$userId","username","localeCompare","json","err","console","error","status","message","post","_record","today","Date","toISOString","split","record","findOne","now","checkInTime","workStart","setHours","workEnd","diffMinutes","Math","floor","save","overtimeStartMinutes","getHours","getMinutes","overtimeStart","overtimeEnd","max","round","module","exports"],"sources":["C:/HRM_Project/frontend/src/pages/user/Attendance.js"],"sourcesContent":["// routes/attendance.js\r\nconst express = require(\"express\");\r\nconst router = express.Router();\r\nconst auth = require(\"../middleware/authMiddleware\");\r\nconst Attendance = require(\"../models/Attendance\");\r\nconst Employee = require(\"../models/Employee\");\r\n\r\n// ========================= LẤY LỊCH SỬ CHẤM CÔNG =========================\r\nrouter.get(\"/\", auth([\"admin\", \"employee\", \"manager\"]), async (req, res) => {\r\n  try {\r\n    let employees, attendanceRecords;\r\n\r\n    if (req.user.role === \"admin\") {\r\n      employees = await Employee.find().populate(\"userId\", \"username role\");\r\n      attendanceRecords = await Attendance.find().populate(\"userId\", \"username role\");\r\n    } else {\r\n      employees = await Employee.find({ userId: req.user.id }).populate(\"userId\", \"username role\");\r\n      attendanceRecords = await Attendance.find({ userId: req.user.id }).populate(\"userId\", \"username role\");\r\n    }\r\n\r\n    // tạo map userId → danh sách record\r\n    const attendanceMap = new Map();\r\n    attendanceRecords.forEach((a) => {\r\n      const uid = a.userId?._id.toString();\r\n      if (!attendanceMap.has(uid)) attendanceMap.set(uid, []);\r\n      attendanceMap.get(uid).push(a);\r\n    });\r\n\r\n    // đảm bảo mỗi nhân viên đều có hàng hiển thị\r\n    const result = [];\r\n    for (const emp of employees) {\r\n      const uid = emp.userId?._id.toString();\r\n      const records = attendanceMap.get(uid);\r\n      if (records && records.length > 0) {\r\n        records.forEach((r) => {\r\n          result.push({\r\n            _id: r._id,\r\n            userId: r.userId,\r\n            date: r.date,\r\n            checkIn: r.checkIn,\r\n            checkOut: r.checkOut,\r\n            lateMinutes: r.lateMinutes ?? 0,\r\n            overtimeHours: r.overtimeHours ?? 0,\r\n            totalDays: r.totalDays ?? 0,\r\n          });\r\n        });\r\n      } else {\r\n        result.push({\r\n          _id: uid + \"-empty\",\r\n          userId: emp.userId,\r\n          date: null,\r\n          checkIn: null,\r\n          checkOut: null,\r\n          lateMinutes: 0,\r\n          overtimeHours: 0,\r\n          totalDays: 0,\r\n        });\r\n      }\r\n    }\r\n\r\n    // sắp xếp theo username\r\n    result.sort((a, b) => (a.userId?.username || \"\").localeCompare(b.userId?.username || \"\"));\r\n    res.json(result);\r\n  } catch (err) {\r\n    console.error(\"❌ Lỗi lấy chấm công:\", err);\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n});\r\n\r\n// ========================= CHECK-IN =========================\r\nrouter.post(\"/check-in\", auth([\"admin\", \"employee\", \"manager\"]), async (req, res) => {\r\n  try {\r\n    const today = new Date().toISOString().split(\"T\")[0];\r\n    let record = await Attendance.findOne({ userId: req.user.id, date: today });\r\n\r\n    if (record?.checkIn) {\r\n      return res.status(400).json({ error: \"Hôm nay bạn đã Check-in rồi.\" });\r\n    }\r\n\r\n    const now = new Date();\r\n    const checkInTime = new Date(now);\r\n    const workStart = new Date(now.setHours(7, 0, 0, 0)); // 7:00 sáng\r\n    const workEnd = new Date(now.setHours(17, 0, 0, 0)); // 17:00 chiều\r\n\r\n    // tính đi trễ (phút)\r\n    const diffMinutes = Math.floor((checkInTime - workStart) / 60000);\r\n    const lateMinutes = diffMinutes > 0 ? diffMinutes : 0;\r\n\r\n    // tạo bản ghi mới\r\n    record = new Attendance({\r\n      userId: req.user.id,\r\n      date: today,\r\n      checkIn: checkInTime,\r\n      checkOut: workEnd,       // ✅ mặc định 17h chiều\r\n      lateMinutes,\r\n      totalDays: 1,            // ✅ có check-in = 1 ngày công\r\n      overtimeHours: 0,\r\n      status: \"Present\",\r\n    });\r\n\r\n    await record.save();\r\n    res.json({ message: \"✅ Check-in thành công (ra 17:00 mặc định)\", record });\r\n  } catch (err) {\r\n    console.error(\"❌ Lỗi check-in:\", err);\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n});\r\n\r\n// ========================= BẮT ĐẦU TĂNG CA =========================\r\nrouter.post(\"/overtime\", auth([\"admin\", \"employee\", \"manager\"]), async (req, res) => {\r\n  try {\r\n    const today = new Date().toISOString().split(\"T\")[0];\r\n    const record = await Attendance.findOne({ userId: req.user.id, date: today });\r\n\r\n    if (!record) return res.status(404).json({ error: \"Bạn chưa Check-in hôm nay.\" });\r\n\r\n    const now = new Date();\r\n    const overtimeStartMinutes = now.getHours() * 60 + now.getMinutes();\r\n    if (overtimeStartMinutes < 17 * 60) {\r\n      return res.status(400).json({ error: \"⏰ Tăng ca chỉ được bắt đầu sau 17:00.\" });\r\n    }\r\n\r\n    record.overtimeStart = now;\r\n    await record.save();\r\n\r\n    res.json({ message: \"✅ Bắt đầu tăng ca\", record });\r\n  } catch (err) {\r\n    console.error(\"❌ Lỗi bắt đầu tăng ca:\", err);\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n});\r\n\r\n// ========================= KẾT THÚC TĂNG CA =========================\r\nrouter.post(\"/overtime/checkout\", auth([\"admin\", \"employee\", \"manager\"]), async (req, res) => {\r\n  try {\r\n    const today = new Date().toISOString().split(\"T\")[0];\r\n    const record = await Attendance.findOne({ userId: req.user.id, date: today });\r\n\r\n    if (!record || !record.overtimeStart)\r\n      return res.status(404).json({ error: \"Bạn chưa bắt đầu tăng ca.\" });\r\n\r\n    record.overtimeEnd = new Date();\r\n    const overtimeHours = Math.max(\r\n      0,\r\n      (record.overtimeEnd - record.overtimeStart) / 36e5\r\n    );\r\n    record.overtimeHours = Math.round(overtimeHours * 100) / 100;\r\n\r\n    await record.save();\r\n    res.json({ message: \"✅ Kết thúc tăng ca\", record });\r\n  } catch (err) {\r\n    console.error(\"❌ Lỗi kết thúc tăng ca:\", err);\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}